<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Petrobras - Manutenção de Navios</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <script src="config.js"></script>
    <script src="constants.js"></script>
    <script src="api.js"></script>
    <script src="components.js"></script>
    <script src="data-analysis.js"></script>
</head>

<body>
    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="logo">
            <img src="petrobras-logo.png" alt="Petrobras">
        </div>
        <nav class="nav-menu-center">
            <a href="index.html" class="nav-item active">
                <span class="material-icons">home</span>
            </a>
            <a href="navios.html" class="nav-item">
                <span class="material-icons">directions_boat</span>
            </a>
            <a href="#" class="nav-item">
                <span class="material-icons">chat</span>
            </a>
        </nav>
        <nav class="nav-menu-bottom">
            <a href="#" class="nav-item">
                <span class="material-icons">settings</span>
            </a>
            <a href="#" class="nav-item">
                <span class="material-icons">logout</span>
            </a>
        </nav>
    </aside>

    <!-- Main Content -->
    <div class="main-container">
        <!-- Header -->
        <header class="header">
            <h1 class="page-title">Dashboard</h1>
            <div class="header-actions">
                <div class="search-bar">
                    <span class="material-icons search-icon">search</span>
                    <input type="text" placeholder="Pesquise por algo">
                </div>
                <button class="notification-btn">
                    <span class="material-icons">notifications_none</span>
                </button>
                <div class="user-avatar">
                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 40 40'%3E%3Ccircle cx='20' cy='20' r='20' fill='%234D4D4D'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' fill='white' font-family='Arial' font-weight='bold' font-size='16'%3EU%3C/text%3E%3C/svg%3E"
                        alt="User">
                </div>
            </div>
        </header>

        <!-- Dashboard Content -->
        <main class="content">
            <!-- Highlights Section -->
            <section class="highlights-section">
                <div class="section-header">
                    <h2>Destaques</h2>
                    <select class="time-filter">
                        <option>Últimos 30 dias</option>
                        <option>Últimos 60 dias</option>
                        <option>Últimos 90 dias</option>
                    </select>
                </div>
                <div class="highlights-grid">
                    <div class="highlight-card">
                        <div class="card-icon green">
                            <span class="material-icons">directions_boat</span>
                        </div>
                        <div class="card-content">
                            <p class="card-label">Navios ativos</p>
                            <p class="card-value" id="activeShips">-</p>
                            <p class="card-change positive">
                                <span class="material-icons">trending_up</span>
                                <span id="activeShipsChange">Carregando...</span>
                            </p>
                        </div>
                    </div>
                    <div class="highlight-card">
                        <div class="card-icon green">
                            <span class="material-icons">speed</span>
                        </div>
                        <div class="card-content">
                            <p class="card-label">Velocidade média</p>
                            <p class="card-value" id="avgSpeed">-</p>
                            <p class="card-change" id="avgSpeedChange">
                                <span class="material-icons">trending_up</span>
                                Carregando...
                            </p>
                        </div>
                    </div>
                    <div class="highlight-card">
                        <div class="card-icon green">
                            <span class="material-icons">attach_money</span>
                        </div>
                        <div class="card-content">
                            <p class="card-label">Economia acumulada</p>
                            <p class="card-value" id="totalSavings">R$ 0,00</p>
                            <p class="card-change positive">
                                <span class="material-icons">trending_up</span>
                                <span id="totalSavingsChange">Carregando...</span>
                            </p>
                        </div>
                    </div>
                    <div class="highlight-card">
                        <div class="card-icon green">
                            <span class="material-icons">cloud</span>
                        </div>
                        <div class="card-content">
                            <p class="card-label">Emissões evitadas</p>
                            <p class="card-value" id="emissionsSaved">0 ton CO₂</p>
                            <p class="card-change positive">
                                <span class="material-icons">trending_up</span>
                                <span id="emissionsSavedChange">Carregando...</span>
                            </p>
                        </div>
                    </div>
                    <div class="highlight-card">
                        <div class="card-icon blue">
                            <span class="material-icons">water_drop</span>
                        </div>
                        <div class="card-content">
                            <p class="card-label">Nível médio de biofouling</p>
                            <p class="card-value" id="avgBiofoulingLevel">-</p>
                            <p class="card-change" id="avgBiofoulingLevelChange">
                                <span class="material-icons">info</span>
                                Baseado em predições
                            </p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Biofouling Analysis Section -->
            <section class="biofouling-analysis-section">
                <div class="section-header">
                    <h2>Análise de Biofouling</h2>
                    <p class="section-subtitle">Insights baseados em predições realizadas</p>
                </div>
                
                <!-- Impact Summary Cards -->
                <div class="highlights-grid" id="biofoulingImpactCards">
                    <div class="highlight-card analysis-card">
                        <div class="card-icon orange">
                            <span class="material-icons">local_gas_station</span>
                        </div>
                        <div class="card-content">
                            <p class="card-label">Combustível Extra Total</p>
                            <p class="card-value" id="totalExtraFuel">0,00</p>
                            <p class="card-sublabel">toneladas</p>
                        </div>
                    </div>
                    <div class="highlight-card analysis-card">
                        <div class="card-icon red">
                            <span class="material-icons">attach_money</span>
                        </div>
                        <div class="card-content">
                            <p class="card-label">Custo Total (BRL)</p>
                            <p class="card-value" id="totalCostBRL">R$ 0,00</p>
                            <p class="card-sublabel" id="totalCostUSD">US$ 0,00</p>
                        </div>
                    </div>
                    <div class="highlight-card analysis-card">
                        <div class="card-icon purple">
                            <span class="material-icons">cloud</span>
                        </div>
                        <div class="card-content">
                            <p class="card-label">CO₂ Extra Total</p>
                            <p class="card-value" id="totalExtraCO2">0,00</p>
                            <p class="card-sublabel">toneladas</p>
                        </div>
                    </div>
                    <div class="highlight-card analysis-card">
                        <div class="card-icon blue">
                            <span class="material-icons">speed</span>
                        </div>
                        <div class="card-content">
                            <p class="card-label">Potência Extra Total</p>
                            <p class="card-value" id="totalExtraPower">0</p>
                            <p class="card-sublabel">kW</p>
                        </div>
                    </div>
                </div>

                <!-- Priority Ships and Distribution -->
                <div class="details-grid biofouling-details-grid">
                    <!-- Priority Ships List -->
                    <div class="info-card">
                        <h3>Navios Prioritários para Limpeza</h3>
                        <div id="priorityShipsList">
                            <p style="text-align: center; color: #4D4D4D; padding: 20px;">
                                Carregando dados de priorização...
                            </p>
                        </div>
                    </div>

                    <!-- Biofouling Level Distribution -->
                    <div class="info-card">
                        <h3>Distribuição de Níveis de Biofouling</h3>
                        <div id="biofoulingDistribution">
                            <canvas id="distributionChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Recommendations -->
                <div class="info-card recommendations-card" id="recommendationsCard" style="display: none;">
                    <h3>Recomendações</h3>
                    <div id="recommendationsList"></div>
                </div>
            </section>

            <!-- Detailed Information Section -->
            <section class="detailed-section">
                <h2>Informações detalhadas</h2>
                <div class="details-grid">
                    <!-- Maintenance Chart -->
                    <div class="info-card chart-card">
                        <h3>Quantidade de manutenções</h3>
                        <canvas id="maintenanceChart"></canvas>
                    </div>

                    <!-- Status List -->
                    <div class="info-card">
                        <h3>Lista de status</h3>
                        <table class="status-table">
                            <thead>
                                <tr>
                                    <th>Navio</th>
                                    <th>Localização</th>
                                    <th>Nível Biofouling</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="statusTableBody">
                                <tr>
                                    <td colspan="3" style="text-align: center; padding: 20px;">
                                        <div class="loading-spinner" style="margin: 0 auto;"></div>
                                        <p style="margin-top: 10px; color: #4D4D4D;">Carregando dados...</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <a href="#" class="view-more">Ver lista completa <span
                                class="material-icons">arrow_forward</span></a>
                    </div>

                    <!-- Map -->
                    <div class="info-card map-card">
                        <h3>Localização das manutenções</h3>
                        <div class="map-container">
                            <svg viewBox="0 0 400 300" class="map-svg">
                                <!-- Simplified Brazil map -->
                                <path
                                    d="M 200 50 L 250 80 L 280 120 L 270 180 L 240 240 L 200 260 L 160 240 L 140 200 L 130 160 L 140 120 L 170 80 Z"
                                    fill="#E9E9E9" stroke="#4D4D4D" stroke-width="1" />
                                <!-- Location markers -->
                                <circle cx="200" cy="100" r="6" fill="#1A932E" />
                                <circle cx="220" cy="140" r="6" fill="#1A932E" />
                                <circle cx="190" cy="180" r="6" fill="#1A932E" />
                            </svg>
                            <div class="map-legend">
                                <div class="legend-item">
                                    <strong>Navio</strong>
                                    <strong>Responsável</strong>
                                    <strong>Progresso</strong>
                                </div>
                                <div class="legend-item">
                                    <span>São Sebastião</span>
                                    <span>Manoel Neto</span>
                                    <span class="progress-bar"><span class="progress-fill"
                                            style="width: 100%"></span></span>
                                </div>
                                <div class="legend-item">
                                    <span>André Rebouças</span>
                                    <span>Felipe Augusto</span>
                                    <span class="progress-bar"><span class="progress-fill progress-maintenance"
                                            style="width: 71%"></span></span>
                                </div>
                                <div class="legend-item">
                                    <span>Henrique Dias</span>
                                    <span>Mateus Oliveira</span>
                                    <span class="progress-bar"><span class="progress-fill progress-maintenance"
                                            style="width: 62%"></span></span>
                                </div>
                                <div class="legend-item">
                                    <span>Rio Grande</span>
                                    <span>Amanda Santos</span>
                                    <span class="progress-bar"><span class="progress-fill progress-late"
                                            style="width: 28%"></span></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Fleet Status Proportion -->
                    <div class="info-card">
                        <h3>Proporção de status da frota</h3>
                        <div class="treemap-container" id="fleetProportionTreemap">
                            <div class="treemap-item treemap-ok">
                                <span class="treemap-label">Limpo</span>
                                <span class="treemap-value">0%</span>
                            </div>
                            <div class="treemap-item treemap-maintenance">
                                <span class="treemap-label">Suja</span>
                                <span class="treemap-value">0%</span>
                            </div>
                            <div class="treemap-item treemap-late">
                                <span class="treemap-label">Manutenção</span>
                                <span class="treemap-value">0%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Embedded data for offline/deploy access -->
    <script>
        // Embed analise_biofouling.json data directly for reliable access
        const ANALISE_BIOFOULING_DATA = [
            {"sessionId":40200000218,"startGMTDate":"2021-08-26 13:55:00","shipName":"NAVIO TESTE 3","Biofouling_Level":2,"Risk_Category":"High","Action":"MANTER MONITORAMENTO","Confidence":0.95,"Extra_Fuel_Tons":1.14,"Extra_Cost_USD":593.13,"Extra_Cost_BRL":3558.76,"Extra_CO2_Tons":3.55,"Total_Cost_USD":934.32,"Total_Cost_BRL":5605.94,"Power_Increase_Percent":55.88},
            {"sessionId":40200000237,"startGMTDate":"2021-08-30 10:00:00","shipName":"NAVIO TESTE 3","Biofouling_Level":3,"Risk_Category":"Critical","Action":"AGENDAR LIMPEZA IMEDIATA","Confidence":0.95,"Extra_Fuel_Tons":2.49,"Extra_Cost_USD":1296.38,"Extra_Cost_BRL":7778.28,"Extra_CO2_Tons":7.76,"Total_Cost_USD":2042.12,"Total_Cost_BRL":12252.75,"Power_Increase_Percent":106.67},
            {"sessionId":40200000268,"startGMTDate":"2021-08-30 11:30:00","shipName":"NAVIO TESTE 3","Biofouling_Level":2,"Risk_Category":"High","Action":"MANTER MONITORAMENTO","Confidence":0.95,"Extra_Fuel_Tons":127.28,"Extra_Cost_USD":66184.65,"Extra_Cost_BRL":397107.92,"Extra_CO2_Tons":396.34,"Total_Cost_USD":104257.48,"Total_Cost_BRL":625544.9,"Power_Increase_Percent":55.88},
            {"sessionId":40200000294,"startGMTDate":"2021-09-07 08:10:00","shipName":"NAVIO TESTE 3","Biofouling_Level":3,"Risk_Category":"Critical","Action":"AGENDAR LIMPEZA IMEDIATA","Confidence":0.95,"Extra_Fuel_Tons":5.32,"Extra_Cost_USD":2764.63,"Extra_Cost_BRL":16587.77,"Extra_CO2_Tons":16.56,"Total_Cost_USD":4354.99,"Total_Cost_BRL":26129.91,"Power_Increase_Percent":106.67},
            {"sessionId":40200000303,"startGMTDate":"2021-09-10 03:05:00","shipName":"NAVIO TESTE 3","Biofouling_Level":2,"Risk_Category":"High","Action":"MANTER MONITORAMENTO","Confidence":0.95,"Extra_Fuel_Tons":4.94,"Extra_Cost_USD":2568.77,"Extra_Cost_BRL":15412.6,"Extra_CO2_Tons":15.38,"Total_Cost_USD":4046.45,"Total_Cost_BRL":24278.73,"Power_Increase_Percent":55.88},
            {"sessionId":40200000305,"startGMTDate":"2021-09-10 05:00:00","shipName":"NAVIO TESTE 3","Biofouling_Level":2,"Risk_Category":"High","Action":"MANTER MONITORAMENTO","Confidence":0.95,"Extra_Fuel_Tons":149.25,"Extra_Cost_USD":77609.94,"Extra_Cost_BRL":465659.62,"Extra_CO2_Tons":464.76,"Total_Cost_USD":122255.18,"Total_Cost_BRL":733531.0600000001,"Power_Increase_Percent":55.88},
            {"sessionId":40200000323,"startGMTDate":"2021-09-11 22:30:00","shipName":"NAVIO TESTE 3","Biofouling_Level":2,"Risk_Category":"High","Action":"MANTER MONITORAMENTO","Confidence":0.95,"Extra_Fuel_Tons":3.49,"Extra_Cost_USD":1813.74,"Extra_Cost_BRL":10882.42,"Extra_CO2_Tons":10.86,"Total_Cost_USD":2857.09,"Total_Cost_BRL":17142.55,"Power_Increase_Percent":55.88},
            {"sessionId":40200000360,"startGMTDate":"2021-09-14 23:00:00","shipName":"NAVIO TESTE 3","Biofouling_Level":2,"Risk_Category":"High","Action":"MANTER MONITORAMENTO","Confidence":0.95,"Extra_Fuel_Tons":89.83,"Extra_Cost_USD":46713.54,"Extra_Cost_BRL":280281.25,"Extra_CO2_Tons":279.74,"Total_Cost_USD":73585.58,"Total_Cost_BRL":441513.49,"Power_Increase_Percent":55.88},
            {"sessionId":40200000377,"startGMTDate":"2021-09-15 08:20:00","shipName":"NAVIO TESTE 3","Biofouling_Level":3,"Risk_Category":"Critical","Action":"AGENDAR LIMPEZA IMEDIATA","Confidence":0.95,"Extra_Fuel_Tons":0.25,"Extra_Cost_USD":129.17,"Extra_Cost_BRL":775.03,"Extra_CO2_Tons":0.77,"Total_Cost_USD":203.48,"Total_Cost_BRL":1220.86,"Power_Increase_Percent":106.67},
            {"sessionId":40200000383,"startGMTDate":"2021-09-16 01:55:00","shipName":"NAVIO TESTE 3","Biofouling_Level":2,"Risk_Category":"High","Action":"MANTER MONITORAMENTO","Confidence":0.95,"Extra_Fuel_Tons":0.78,"Extra_Cost_USD":406.4,"Extra_Cost_BRL":2438.37,"Extra_CO2_Tons":2.43,"Total_Cost_USD":640.17,"Total_Cost_BRL":3841.05,"Power_Increase_Percent":55.88}
        ];
    </script>
    <script src="script.js"></script>
    <script src="dashboard-integration.js"></script>
</body>

</html>